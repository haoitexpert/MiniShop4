@page "/lab1"
<PageTitle>Lab1 - Init</PageTitle>

<h3>Lab 1 - OnInitialized vs OnInitializedAsync</h3>

<p>Message: @message</p>

<button class="btn btn-primary" @onclick="Reset">Reset (new instance needed: refresh page)</button>

<ul>
    @foreach (var e in events)
    {
        <li>@e</li>
    }
</ul>

@code {
    private string message = "Starting...";
    private List<string> events = new();

    protected override void OnInitialized()
    {
        events.Add("OnInitialized: dựng sạp xong cái rụp");
        message = "OnInitialized done";
    }

    protected override async Task OnInitializedAsync()
    {
        events.Add("OnInitializedAsync: đang đợi lấy hàng (500ms)...");
        await Task.Delay(500);
        message = "OnInitializedAsync done (after await)";
        events.Add("OnInitializedAsync: lấy hàng về, cập nhật message");
    }

    private void Reset()
    {
        // Reset state chứ không làm init chạy lại (init chỉ chạy 1 lần mỗi instance).
        events.Clear();
        message = "Reset state only (refresh page to re-init)";
        events.Add("Reset clicked (OnInitialized không tự chạy lại đâu)");
    }
}
